<!DOCTYPE html><html lang="en"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1.0"><meta name="generator" content="rustdoc"><meta name="description" content="Smithay: the Wayland compositor smithy"><title>smithay - Rust</title><script>if(window.location.protocol!=="file:")document.head.insertAdjacentHTML("beforeend","SourceSerif4-Regular-46f98efaafac5295.ttf.woff2,FiraSans-Regular-018c141bf0843ffd.woff2,FiraSans-Medium-8f9a781e4970d388.woff2,SourceCodePro-Regular-562dcc5011b6de7d.ttf.woff2,SourceCodePro-Semibold-d899c5a5c4aeb14a.ttf.woff2".split(",").map(f=>`<link rel="preload" as="font" type="font/woff2" crossorigin href="../static.files/${f}">`).join(""))</script><link rel="stylesheet" href="../static.files/normalize-76eba96aa4d2e634.css"><link rel="stylesheet" href="../static.files/rustdoc-dd39b87e5fcfba68.css"><meta name="rustdoc-vars" data-root-path="../" data-static-root-path="../static.files/" data-current-crate="smithay" data-themes="" data-resource-suffix="" data-rustdoc-version="1.80.0-nightly (7c52d2db6 2024-06-03)" data-channel="nightly" data-search-js="search-d52510db62a78183.js" data-settings-js="settings-4313503d2e1961c2.js" ><script src="../static.files/storage-118b08c4c78b968e.js"></script><script defer src="../crates.js"></script><script defer src="../static.files/main-20a3ad099b048cf2.js"></script><noscript><link rel="stylesheet" href="../static.files/noscript-df360f571f6edeae.css"></noscript><link rel="alternate icon" type="image/png" href="../static.files/favicon-32x32-422f7d1d52889060.png"><link rel="icon" type="image/svg+xml" href="../static.files/favicon-2c020d218678b618.svg"></head><body class="rustdoc mod crate"><!--[if lte IE 11]><div class="warning">This old browser is unsupported and will most likely display funky things.</div><![endif]--><nav class="mobile-topbar"><button class="sidebar-menu-toggle" title="show sidebar"></button></nav><nav class="sidebar"><div class="sidebar-crate"><h2><a href="../smithay/index.html">smithay</a><span class="version">0.3.0</span></h2></div><div class="sidebar-elems"><ul class="block"><li><a id="all-types" href="all.html">All Items</a></li></ul><section><ul class="block"><li><a href="#modules">Modules</a></li><li><a href="#macros">Macros</a></li></ul></section></div></nav><div class="sidebar-resizer"></div><main><div class="width-limiter"><rustdoc-search></rustdoc-search><section id="main-content" class="content"><div class="main-heading"><h1>Crate <a class="mod" href="#">smithay</a><button id="copy-path" title="Copy item path to clipboard">Copy item path</button></h1><span class="out-of-band"><a class="src" href="../src/smithay/lib.rs.html#1-78">source</a> · <button id="toggle-all-docs" title="collapse all docs">[<span>&#x2212;</span>]</button></span></div><details class="toggle top-doc" open><summary class="hideme"><span>Expand description</span></summary><div class="docblock"><h2 id="smithay-the-wayland-compositor-smithy"><a class="doc-anchor" href="#smithay-the-wayland-compositor-smithy">§</a>Smithay: the Wayland compositor smithy</h2>
<p>This crate is a general framework for building wayland compositors. It currently focuses on low-level,
helpers and abstractions, handling most of the system-level and wayland protocol interactions.
The window management and drawing logic is however at the time not provided (but helpers for this
are planned for future version).</p>
<h3 id="structure-of-the-crate"><a class="doc-anchor" href="#structure-of-the-crate">§</a>Structure of the crate</h3>
<p>The provided helpers are split into two main modules:</p>
<ul>
<li>
<p><a href="backend/index.html" title="mod smithay::backend"><code>backend</code></a> contains helpers for interacting with the operating
system, such as session management, interactions with the graphic stack
and input processing.</p>
</li>
<li>
<p><a href="wayland/index.html" title="mod smithay::wayland"><code>wayland</code></a> contains helpers for interacting with wayland clients
according to the wayland protocol.</p>
<p>In addition, the <a href="xwayland/index.html" title="mod smithay::xwayland"><code>xwayland</code></a> module contains helpers for managing an
XWayland instance if you want to support it. See the documentation of
these respective modules for information about their usage.</p>
</li>
</ul>
<h3 id="general-principles-for-using-smithay"><a class="doc-anchor" href="#general-principles-for-using-smithay">§</a>General principles for using Smithay</h3><h4 id="the-event-loop-and-state-handling"><a class="doc-anchor" href="#the-event-loop-and-state-handling">§</a>The event loop and state handling</h4>
<p>Smithay is built around <a href="../calloop/index.html" title="mod calloop"><code>calloop</code></a>, a callback-oriented event loop, which fits naturally with the
general behavior of a wayland compositor: waiting for events to occur and react to them (be it
client requests, user input, or hardware events such as <code>vblank</code>).</p>
<p>Using a callback-heavy structure however poses the question of state management: a lot of state needs
to be accessed from many different callbacks. To avoid an heavy requirement on shared pointers such
as <code>Rc</code> and <code>Arc</code> and the synchronization they require, <a href="../calloop/index.html" title="mod calloop"><code>calloop</code></a> allows you to provide a mutable
reference to a value, that will be passed down to most callbacks. This structure provides
easy access to a centralized mutable state without synchronization (as the callback invocation is
<em>always</em> sequential), and is the recommended way to of structuring your compositor.
TODO: Add a section here how this links to wayland-server’s <code>Dispatch</code> and link to the wayland-server
docs, once they exist for 0.30.</p>
<p>Several objects, in particular on the wayland clients side, can exist as multiple instances where each
instance has its own associated state. For these situations, these objects provide an interface allowing
you to associate an arbitrary value to them, that you can access at any time from the object itself
(rather than having your own container in which you search for the appropriate value when you need it).</p>
<h4 id="logging"><a class="doc-anchor" href="#logging">§</a>Logging</h4>
<p>Smithay makes extensive use of <a href="../tracing/index.html" title="mod tracing"><code>tracing</code></a> for its internal logging.</p>
<p>For release builds it is recommended to limit the log level during compile time.
This can be done by adding a dependency to <a href="../tracing/index.html" title="mod tracing"><code>tracing</code></a> and enabling the corresponding features.
For example to enable <code>trace</code> messages for debug builds, but limit release builds to <code>debug</code> add
the following in your binary crate <code>Cargo.toml</code>:</p>
<div class="example-wrap"><pre class="language-toml"><code>[dependencies]
tracing = { version = &quot;0.1&quot;, features = [&quot;max_level_trace&quot;, &quot;release_max_level_debug&quot;] }
</code></pre></div>
<p>If you do not want to use <a href="../tracing/index.html" title="mod tracing"><code>tracing</code></a> for your compositor, refer to <a href="../tracing/index.html#log-compatibility" title="mod tracing"><code>log compatibility</code></a>
for how to forward smithays debug output to other <code>log</code> compatible frameworks.</p>
</div></details><h2 id="modules" class="section-header">Modules<a href="#modules" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="mod" href="backend/index.html" title="mod smithay::backend">backend</a></div><div class="desc docblock-short">Backend (rendering/input) helpers</div></li><li><div class="item-name"><a class="mod" href="desktop/index.html" title="mod smithay::desktop">desktop</a><span class="stab portability" title="Available on crate feature `desktop` only"><code>desktop</code></span></div><div class="desc docblock-short">Desktop management helpers</div></li><li><div class="item-name"><a class="mod" href="input/index.html" title="mod smithay::input">input</a></div><div class="desc docblock-short">Input abstractions</div></li><li><div class="item-name"><a class="mod" href="output/index.html" title="mod smithay::output">output</a></div><div class="desc docblock-short">Output</div></li><li><div class="item-name"><a class="mod" href="reexports/index.html" title="mod smithay::reexports">reexports</a></div><div class="desc docblock-short">Reexports of crates, that are part of the public api, for convenience</div></li><li><div class="item-name"><a class="mod" href="utils/index.html" title="mod smithay::utils">utils</a></div><div class="desc docblock-short">Various utilities functions and types</div></li><li><div class="item-name"><a class="mod" href="wayland/index.html" title="mod smithay::wayland">wayland</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Protocol-related utilities</div></li><li><div class="item-name"><a class="mod" href="xwayland/index.html" title="mod smithay::xwayland">xwayland</a><span class="stab portability" title="Available on crate feature `xwayland` only"><code>xwayland</code></span></div><div class="desc docblock-short">XWayland utilities</div></li></ul><h2 id="macros" class="section-header">Macros<a href="#macros" class="anchor">§</a></h2><ul class="item-table"><li><div class="item-name"><a class="macro" href="macro.delegate_alpha_modifier.html" title="macro smithay::delegate_alpha_modifier">delegate_alpha_modifier</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the alpha modifier protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_compositor.html" title="macro smithay::delegate_compositor">delegate_compositor</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_content_type.html" title="macro smithay::delegate_content_type">delegate_content_type</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the wp content type protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_cursor_shape.html" title="macro smithay::delegate_cursor_shape">delegate_cursor_shape</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_data_control.html" title="macro smithay::delegate_data_control">delegate_data_control</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_data_device.html" title="macro smithay::delegate_data_device">delegate_data_device</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_dmabuf.html" title="macro smithay::delegate_dmabuf">delegate_dmabuf</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the linux dmabuf to <a href="wayland/dmabuf/struct.DmabufState.html" title="struct smithay::wayland::dmabuf::DmabufState"><code>DmabufState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_drm_lease.html" title="macro smithay::delegate_drm_lease">delegate_drm_lease</a><span class="stab portability" title="Available on crate features `backend_drm` and `wayland_frontend` only"><code>backend_drm</code> and <code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the drm-lease protocol to <a href="wayland/drm_lease/struct.DrmLeaseState.html" title="struct smithay::wayland::drm_lease::DrmLeaseState"><code>DrmLeaseState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_fractional_scale.html" title="macro smithay::delegate_fractional_scale">delegate_fractional_scale</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_idle_inhibit.html" title="macro smithay::delegate_idle_inhibit">delegate_idle_inhibit</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_idle_notify.html" title="macro smithay::delegate_idle_notify">delegate_idle_notify</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the ext idle notify protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_input_method_manager.html" title="macro smithay::delegate_input_method_manager">delegate_input_method_manager</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_kde_decoration.html" title="macro smithay::delegate_kde_decoration">delegate_kde_decoration</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_keyboard_shortcuts_inhibit.html" title="macro smithay::delegate_keyboard_shortcuts_inhibit">delegate_keyboard_shortcuts_inhibit</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the keyboard shortcuts inhibit protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_layer_shell.html" title="macro smithay::delegate_layer_shell">delegate_layer_shell</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of wlr layer shell to <a href="wayland/shell/wlr_layer/struct.WlrLayerShellState.html" title="struct smithay::wayland::shell::wlr_layer::WlrLayerShellState"><code>WlrLayerShellState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_output.html" title="macro smithay::delegate_output">delegate_output</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_pointer_constraints.html" title="macro smithay::delegate_pointer_constraints">delegate_pointer_constraints</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_pointer_gestures.html" title="macro smithay::delegate_pointer_gestures">delegate_pointer_gestures</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the pointer gestures protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_presentation.html" title="macro smithay::delegate_presentation">delegate_presentation</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_primary_selection.html" title="macro smithay::delegate_primary_selection">delegate_primary_selection</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_relative_pointer.html" title="macro smithay::delegate_relative_pointer">delegate_relative_pointer</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the relative pointer protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_seat.html" title="macro smithay::delegate_seat">delegate_seat</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_security_context.html" title="macro smithay::delegate_security_context">delegate_security_context</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the security context protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_session_lock.html" title="macro smithay::delegate_session_lock">delegate_session_lock</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_shm.html" title="macro smithay::delegate_shm">delegate_shm</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_tablet_manager.html" title="macro smithay::delegate_tablet_manager">delegate_tablet_manager</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_text_input_manager.html" title="macro smithay::delegate_text_input_manager">delegate_text_input_manager</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_viewporter.html" title="macro smithay::delegate_viewporter">delegate_viewporter</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_virtual_keyboard_manager.html" title="macro smithay::delegate_virtual_keyboard_manager">delegate_virtual_keyboard_manager</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_activation.html" title="macro smithay::delegate_xdg_activation">delegate_xdg_activation</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xdg activation to <a href="wayland/xdg_activation/struct.XdgActivationState.html" title="struct smithay::wayland::xdg_activation::XdgActivationState"><code>XdgActivationState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_decoration.html" title="macro smithay::delegate_xdg_decoration">delegate_xdg_decoration</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xdg decoration to <a href="wayland/shell/xdg/decoration/struct.XdgDecorationState.html" title="struct smithay::wayland::shell::xdg::decoration::XdgDecorationState"><code>XdgDecorationState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_dialog.html" title="macro smithay::delegate_xdg_dialog">delegate_xdg_dialog</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xdg dialog to <a href="wayland/shell/xdg/dialog/struct.XdgDialogState.html" title="struct smithay::wayland::shell::xdg::dialog::XdgDialogState"><code>XdgDialogState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_foreign.html" title="macro smithay::delegate_xdg_foreign">delegate_xdg_foreign</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xdg foreign to <a href="wayland/xdg_foreign/struct.XdgForeignState.html" title="struct smithay::wayland::xdg_foreign::XdgForeignState"><code>XdgForeignState</code></a>.</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xdg_shell.html" title="macro smithay::delegate_xdg_shell">delegate_xdg_shell</a><span class="stab portability" title="Available on crate feature `wayland_frontend` only"><code>wayland_frontend</code></span></div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xwayland_keyboard_grab.html" title="macro smithay::delegate_xwayland_keyboard_grab">delegate_xwayland_keyboard_grab</a><span class="stab portability" title="Available on crate features `xwayland` and `wayland_frontend` only"><code>xwayland</code> and <code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xwayland keyboard grab protocol</div></li><li><div class="item-name"><a class="macro" href="macro.delegate_xwayland_shell.html" title="macro smithay::delegate_xwayland_shell">delegate_xwayland_shell</a><span class="stab portability" title="Available on crate features `xwayland` and `wayland_frontend` only"><code>xwayland</code> and <code>wayland_frontend</code></span></div><div class="desc docblock-short">Macro to delegate implementation of the xwayland keyboard grab protocol</div></li><li><div class="item-name"><a class="macro" href="macro.egl_platform.html" title="macro smithay::egl_platform">egl_platform</a><span class="stab portability" title="Available on crate feature `backend_egl` only"><code>backend_egl</code></span></div><div class="desc docblock-short">Create a <code>EGLPlatform&lt;'a&gt;</code> for the provided platform.</div></li><li><div class="item-name"><a class="macro" href="macro.render_elements.html" title="macro smithay::render_elements">render_elements</a></div><div class="desc docblock-short">Aggregate multiple types implementing <a href="backend/renderer/element/trait.RenderElement.html" title="trait smithay::backend::renderer::element::RenderElement"><code>RenderElement</code></a> into a single enum type</div></li><li><div class="item-name"><a class="macro" href="macro.space_elements.html" title="macro smithay::space_elements">space_elements</a><span class="stab portability" title="Available on crate feature `desktop` only"><code>desktop</code></span></div><div class="desc docblock-short">Aggregate multiple types implementing <a href="desktop/space/trait.SpaceElement.html" title="trait smithay::desktop::space::SpaceElement"><code>SpaceElement</code></a> into a single enum type to be used
with a [<code>Space</code>].</div></li></ul></section></div></main></body></html>